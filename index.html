<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>reveal.js</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/sky.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Mermaid -->
    <link rel="stylesheet" href="https://cdn.rawgit.com/knsv/mermaid/6.0.0/dist/mermaid.css">
    <style>
      .mermaid .label  {
        color: white;
      }

      .node rect {
        fill: #005894;
      }
    </style>

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
    <style>
      .reveal .footer {
        position: absolute;
        bottom: 1em;
        left: 1em;
        font-size: 0.7em;
      }

      /*Theme overrides*/
      .reveal h1, .reveal h2, .reveal h3, .reveal h4, .reveal h5, .reveal h6 {
        text-transform: none;
      }
    </style>
  </head>
  <body>
    <div class="reveal">
      <div class='footer'>
        <a href="https://grogs.github.io/fullstack-scalajs-workshop">grogs.github.io/fullstack-scalajs-workshop</a>
      </div>
      <div class="slides">
          <!-- TODO sbt new playframework/play-scala-seed.g8 -->
          <!-- Expalin project structure with screenshots: https://www.playframework.com/documentation/2.6.x/Anatomy  ??           -->
        <section data-markdown data-separator="^~~~~" data-separator-vertical="^~" data-notes="^Note:">
          <script type="text/template"> 
### Setup
```
git clone https://github.com/Grogs/fullstack-scalajs-workshop.git
cd fullstack-scalajs-workshop
sbt compile
```
~~~~
## Scala.js workshop  

### Greg Dorrell

~

### About me
 - Backend Scala dev at Expedia
 - Maintainer of [javadoc.io](http://javadoc.io/)
 - Using Scala.js for personal projects for a few years.
~
This workshop

Note:
- I've been using Scala.js for a while, and I think it's great. 
- I want to get the word out that Scala.js is mature and a pleasure to work with
- I think more people should use it!
- So we're going to build a simple website in this workshop.
- It'll be a page showing all the Scala conferences
- I'm assuming most of you are backend developers, so we're going to focus on the frontend parts.
~~~~
Before we get any further...  

### Setup
```
git clone https://github.com/Grogs/fullstack-scalajs-workshop.git
cd fullstack-scalajs-workshop
sbt compile
```

Note:
This will take a while, so kick it off whilst I continue talking.
~~~~

### The plan
You'll feel comfortable going away and building simple apps with Scala.js.

[http://fullstack-scalajs-workshop.herokuapp.com](http://fullstack-scalajs-workshop.herokuapp.com)

Note:
 - We'll have an introductory talk. I can tell you a bit about Scala.js, and its current state. 
 - Then we'll spend the remaining time building out this Scala conference listing site


~~~~
## Play Framework

Note:
- Who has use Play?
- It's one of many web frameworks for Scala. 
- There are two reasons we're using it for this workshop
~
"Just hit refresh"  
  
Note:
- One of the cool features of Play, which is great when you get started
- You don't have to keep stopping and startign your app to see changes.
- Just refresh the page, it'll compile and changes apply them straight away
~
Twirl templates

```scala
//index.scala.html

@(customer: Customer, orders: List[Order])

<h1>Welcome @customer.name!</h1>

<ul>
  @for(order <- orders) {
    <li>@order.title</li>
  }
</ul>
```

<small>Example from https://www.playframework.com/documentation/2.6.x/ScalaTemplates#overview</small>

Note:
- You write these .scala.html files, and they get compiled into a scala function
- So in this example, you'll get a function which takes a customer and an some orders, and returns this page.
- This gives us compile time safety
- Twirl supports Scala.js, so we're going to use it to have a shared template across our frontend and backend.

~~~~
## Scala.js
~
A Scala to JavaScript compiler

Note:

Started by Sebastien Doeraene at EPFL around 5 years ago 

Hooks into the Scala compiler, and instead of emitting JVM bytecode, it emits JavaScript

~

To use it, add a plugin to your SBT build, and enable it for one of your projects.

Note:
* You can use Gradle and Maven, I've not done it myself.
* You can have projects that are cross compile projects for JVM and JS, or just pure JS projects.
* Not everything works (a lot of the Java stdlib isn't available, which Scala stdlib uses).
** But there's enough for it to be usable for a lot of usecases. 
** And it's gettng better over time
~
Or clone one of the [skeleton projects](https://www.scala-js.org/libraries/skeletons.html) to get started: 
- [A pure Scala.js project](https://github.com/lihaoyi/workbench-example-app)
- [Play server and Scala.js client](https://github.com/vmunier/play-with-scalajs-example)

~
Why use Scala.js?  

Note:
* For me, I love Scala, but I also like frontend development. I'd love to use Scala on the frontend.
* But actually, there's a bunch of advantages. Sharing one language across the frontend and backend itself gives a bunch of advantages.
~
Share domain model and business logic across client and server.  

You can refactor some code on the server and the template will be updated!  <!-- .element: class="fragment" -->

Note:
* We're quite used to web frontends being a seperate codebase with a largely seperate dev team.
* But sharing one codebase across the frontend and backend gives you some real advantages.
* You can refactor code (e.g. rename a field on a class in your domain model) and the frontend is just update, without a coordination overhead.
* E.g. Validation logic - you want to do validation on the client-side to provide an rich interactive experience...
** But you need to run it on the server-side to make sure it can't be bypassed.
** It seems a shame to write that twice. Overhead, and there can be differences, which makes it for a poor user experience.
~
Make the client more typesafe  

Catch more errors at compile time

![](wat.png) <!-- .element: class="fragment" -->

Note:
- A lot of people like Scala because of the type safety.
- We want that on the frontend too! Web front-ends are rich complex applications now. Backends are just becoming a collection of REST endpoints.
- Scala is much more type-safe than JavaScript. You'll catch more errors at compile time.
- No more 'Cannot read property blah of undefined' (just like Option got rid of NPEs)
~
The type safety goes further than Typescript.

In TypeScript, you can optionally add types.  
In Scala.js, you can optionally go Dynamic.<!-- .element: class="fragment" -->

Note:
* Fundermentally, in typescript you can optional add types and gradually make parts of your codebase more typesafe.
* But with Scala.js, by default everything is typed and you can optionally go dynamic
** allowing you to call potentially non-existing fields or methods on an object.
** Which can be very useful for using an existing JavaScript library, but is something you really want to avoid.
~ 
It's mature. Version 1.0 is well on the way.

Note:
* No longer experimental (since Feb 2015). 
* People are going it in production.
~
Already has a rich ecosystem.

~
Lots of existing pure scala libraries cross-compile:
- Scalaz
- Cats
- Shapeless
- Monix
- Circe
- Rapture
- Play JSON, Twirl templates
- ScalaTest
- Most of the standard library, e.g. Futures

<!--
  TODO
  Dive into pure-scala libraries
    Futures map very well to JavaScript promises and allow you to move away from callback hell.
  -->
~
Typesafe fascades for existing libraries (varying quality):
- DOM
- jQuery
- React
- Angular
- Vue.js
- D3
- lots more

Note:
- DOM fascades are included.
- React has multiple fascades
  - scalajs-react is the most mature. But it does have quite a steep learning curve.
  - slinky is another great Scala.js for using React 
- Some libraries are inherently stringly-typed like Vue or D3, so you don't gain much safety from the fascade, but good for interop. 

~
Built for Scala.js:
- ScalaTags and friends
- Udash
- Diode
- autowire/sloth for RPC
- scalajs-bundler

[Rapture HTML Demo](https://embed.scalafiddle.io/embed?sfid=hMgI9Bu/1)<!-- .element: class="fragment" -->

Note:
* ScalaTags is a library for generating HTML. 
* Udash is a whole framework for developing apps with Scala.js. It's built and maintained by a Polish company.
* Diode is a 
* Jon Pretty's Rapture HTML takes this to the extreme. 
  * HTML element nesting constaints at compile time
  * and even 'style' attribute's CSS validated at compile time. 
  * [Example](https://embed.scalafiddle.io/embed?sfid=hMgI9Bu/1)
  * See 'Principles of Elegance' talk from ScalaDays NY 2016

  ~
Scala.js even looks similar to JavaScript/ES6, but with types.

[Demo](https://embed.scalafiddle.io/embed?sfid=8D8UXdW/6)
~~~~

###My experiences
~
[artimap.com](http://www.artimap.com)  
Play app with a Scala.JS frontend.  
Scalatags. üòÉ  
Writing fascades for JavaScript libraries. üòÉ  
Scala.Rx. ü§ê  
Google Maps API. ü§ó
~
[fulfilmed.com](http://www.fulfilmed.com)  

`scalajs-react`, and then later `slinky`
  
Note:
- On this other personal project I've been using react.
- I've found slinky to be really nice. It aims to have similar syntax ot ES6-style React, so it's easy to re-use code frameworks for React docs and StackOverflow.
- And both of these libraries now have nice interopability external JavaScript react components. So you can use other people's React components easily.
~~~~
###Resources  

[Scala.js Website](https://www.scala-js.org/)  has tutorials, libraries, skeleton projects

[Scala.js Gitter](https://gitter.im/scala-js/scala-js)


[Hands-on Scala.js](http://www.lihaoyi.com/hands-on-scala-js/) by Li Haoyi  
[Scala.js SPA-tutorial](https://ochrons.github.io/scalajs-spa-tutorial/en/index.html) by Otto Chrons

[Why I bet on Scala.js](http://www.lihaoyi.com/post/FromfirstprinciplesWhyIbetonScalajs.html) by Li Haoyi

Note:
Lots of the libraries mentioned have gitter channels. But you can always go to the scala-js to get pointed in the right direction.
~
Any questions so far?

Note:
Before we move on
~
### What I didn't cover

- Testing
- Changes in Scala.js dependency management
- scalajs-bundler for bundling and a nicer developer feedback loop


Note:
- These are important areas which have actively evolved/improved in the last year.
- These are definitely things you should care about if you want to use Scala.js in customer facing projects
- But then we start needing to thinking about bringing in non-JVM dependencies like selenium and npm.
- Grab me if you want to talk about these
~~~~
## Exercises

Run `sbt run` so you can see your progress at http://localhost:9000

Exercise 1 (Server-side only) - Display the conferences
  - `git checkout exercise1`
  - fix the tests in EventsControllerTest

Exercise 2 (Server and client) - Let the user toggle between past/upcoming/all conferences
- `git checkout exercise2`
- fix test in EventsControllerTest then follow instructions in README

Exercise 3 (Client-side only) - Add a Google Map of all the conferences
- `git checkout exercise3`
- Follow instructions in README
```
          </script>         
        </section>
      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
      // More info https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        history: true,
        showNotes: true,

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
          { src: 'plugin/markdown/marked.js' },
          { src: 'plugin/markdown/markdown.js' },
          { src: 'plugin/notes/notes.js', async: true },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
        ]
      });
    </script>

    <!-- Mermaid -->
    <script src="https://cdn.rawgit.com/knsv/mermaid/6.0.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
  </body>
</html>
